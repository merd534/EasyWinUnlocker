<Window x:Class="SystemAnalyzer.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="System Analyzer" Height="600" Width="900" MinHeight="400" MinWidth="600">
    <TabControl>
        <!-- Вкладка автозагрузки -->
        <TabItem Header="Автозагрузка">
            <DockPanel>
                <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="5">
                    <Label Content="Категория:"/>
                    <ComboBox x:Name="StartupCategoryCombo" Width="120" Margin="5,0" SelectionChanged="StartupCategoryCombo_SelectionChanged">
                        <ComboBoxItem>Все</ComboBoxItem>
                        <ComboBoxItem>HKCU</ComboBoxItem>
                        <ComboBoxItem>HKLM</ComboBoxItem>
                        <ComboBoxItem>Папка</ComboBoxItem>
                        <ComboBoxItem>Планировщик</ComboBoxItem>
                        <ComboBoxItem>Службы</ComboBoxItem>
                    </ComboBox>
                    <Button Content="Обновить" Click="RefreshAllStartup_Click" Margin="5,0"/>
                    <Button Content="Удалить" Click="RemoveStartup_Click" Margin="5,0"/>
                    <Button Content="Включить/Выключить" Click="ToggleStartup_Click" Margin="5,0"/>
                </StackPanel>
                <DataGrid x:Name="StartupGrid" AutoGenerateColumns="False" DockPanel.Dock="Top" Height="400">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Имя" Binding="{Binding Name}" Width="150"/>
                        <DataGridTextColumn Header="Путь" Binding="{Binding Path}" Width="250"/>
                        <DataGridTextColumn Header="Расположение" Binding="{Binding Location}" Width="120"/>
                        <DataGridCheckBoxColumn Header="Включен" Binding="{Binding Enabled}" Width="80"/>
                        <DataGridTextColumn Header="Тип" Binding="{Binding Type}" Width="100"/>
                    </DataGrid.Columns>
                </DataGrid>
                <TextBlock x:Name="StartupStatusText" DockPanel.Dock="Bottom" Margin="5"/>
            </DockPanel>
        </TabItem>

        <!-- Вкладка диспетчера задач -->
        <TabItem Header="Диспетчер задач">
            <DockPanel>
                <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="5">
                    <Label Content="Поиск:"/>
                    <TextBox x:Name="SearchProcessBox" Width="150" Margin="5,0" TextChanged="SearchProcessBox_TextChanged"/>
                    <Button Content="Обновить" Click="RefreshProcesses_Click" Margin="5,0"/>
                    <Button Content="Завершить" Click="KillProcess_Click" Margin="5,0"/>
                </StackPanel>
                <DataGrid x:Name="ProcessesGrid" AutoGenerateColumns="False" DockPanel.Dock="Top" Height="400">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="60"/>
                        <DataGridTextColumn Header="Имя" Binding="{Binding ProcessName}" Width="150"/>
                        <DataGridTextColumn Header="Память (MB)" Binding="{Binding MemoryMB}" Width="80"/>
                        <DataGridTextColumn Header="Приоритет" Binding="{Binding Priority}" Width="80"/>
                        <DataGridTextColumn Header="Путь" Binding="{Binding Path}" Width="250"/>
                    </DataGrid.Columns>
                </DataGrid>
                <TextBlock x:Name="ProcessCountText" DockPanel.Dock="Bottom" Margin="5"/>
            </DockPanel>
        </TabItem>

        <!-- Вкладка проводника -->
        <TabItem Header="Проводник">
            <DockPanel>
                <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="5">
                    <Label Content="Диск:"/>
                    <ComboBox x:Name="DriveCombo" Width="120" Margin="5,0" SelectionChanged="DriveCombo_SelectionChanged"/>
                    <Button Content="Назад" Click="ExplorerBack_Click" Margin="5,0"/>
                    <Button Content="Создать папку" Click="ExplorerNewFolder_Click" Margin="5,0"/>
                    <Button Content="Удалить" Click="ExplorerDelete_Click" Margin="5,0"/>
                    <Button Content="Переименовать" Click="ExplorerRename_Click" Margin="5,0"/>
                </StackPanel>
                <TextBox x:Name="ExplorerPathBox" DockPanel.Dock="Top" Margin="5" KeyDown="ExplorerPathBox_KeyDown"/>
                <Button Content="Перейти" Click="ExplorerGo_Click" DockPanel.Dock="Top" HorizontalAlignment="Right" Margin="5,0,5,5"/>
                <DataGrid x:Name="ExplorerGrid" AutoGenerateColumns="False" DockPanel.Dock="Top" Height="300" 
                          MouseDoubleClick="ExplorerGrid_MouseDoubleClick" SelectionChanged="ExplorerGrid_SelectionChanged">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Имя" Binding="{Binding Name}" Width="200"/>
                        <DataGridTextColumn Header="Тип" Binding="{Binding Type}" Width="120"/>
                        <DataGridTextColumn Header="Размер" Binding="{Binding Size}" Width="80"/>
                        <DataGridTextColumn Header="Изменен" Binding="{Binding Modified}" Width="120"/>
                    </DataGrid.Columns>
                </DataGrid>
                <StackPanel DockPanel.Dock="Bottom" Orientation="Horizontal">
                    <TextBlock x:Name="ExplorerStatus" Margin="5" VerticalAlignment="Center"/>
                    <TextBlock x:Name="SelectedItemInfo" Margin="5" VerticalAlignment="Center"/>
                </StackPanel>
            </DockPanel>
        </TabItem>

        <!-- Вкладка анти-дебаг -->
        <TabItem Header="Анти-дебаг">
            <StackPanel Margin="10">
                <Button Content="Проверить дебаггеры" Click="CheckDebuggers_Click" Margin="0,5"/>
                <Button Content="Завершить дебаггеры" Click="RemoveDebuggers_Click" Margin="0,5"/>
                <Button Content="Проверить виртуализацию" Click="CheckVirtualization_Click" Margin="0,5"/>
                <TextBox x:Name="DebugStatusText" Height="100" Margin="0,5" IsReadOnly="True" VerticalScrollBarVisibility="Auto"/>
                <TextBox x:Name="VirtualizationStatus" Height="100" Margin="0,5" IsReadOnly="True" VerticalScrollBarVisibility="Auto"/>
            </StackPanel>
        </TabItem>

        <!-- Вкладка реестра -->
        <TabItem Header="Реестр">
            <StackPanel Margin="10">
                <Button Content="Просмотреть ключи Run" Click="ViewRunKeys_Click" Margin="0,5"/>
                <Button Content="Удалить из Run" Click="RemoveFromRun_Click" Margin="0,5"/>
                <TextBox x:Name="RunKeysTextBox" Height="200" Margin="0,5" IsReadOnly="True" VerticalScrollBarVisibility="Auto"/>
            </StackPanel>
        </TabItem>

        <!-- Вкладка Winlogon -->
        <TabItem Header="Winlogon">
            <DockPanel>
                <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="5">
                    <Button Content="Загрузить Winlogon" Click="LoadWinlogon_Click" Margin="5,0"/>
                    <Button Content="Удалить ключ" Click="RemoveWinlogonKey_Click" Margin="5,0"/>
                    <Button Content="Добавить ключ" Click="AddWinlogonKey_Click" Margin="5,0"/>
                </StackPanel>
                <DataGrid x:Name="WinlogonGrid" AutoGenerateColumns="False" DockPanel.Dock="Top" Height="300">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Ключ" Binding="{Binding Key}" Width="150"/>
                        <DataGridTextColumn Header="Значение" Binding="{Binding Value}" Width="200"/>
                        <DataGridTextColumn Header="Тип" Binding="{Binding Type}" Width="100"/>
                        <DataGridTextColumn Header="Раздел" Binding="{Binding Section}" Width="150"/>
                    </DataGrid.Columns>
                </DataGrid>
                <TextBlock x:Name="WinlogonStatus" DockPanel.Dock="Bottom" Margin="5"/>
            </DockPanel>
        </TabItem>

        <!-- Вкладка CMDLine -->
        <TabItem Header="CMDLine">
            <DockPanel>
                <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="5">
                    <Button Content="Проверить команды" Click="CheckCMDLine_Click" Margin="5,0"/>
                    <Button Content="Удалить команду" Click="RemoveCMDCommand_Click" Margin="5,0"/>
                    <Button Content="Добавить команду" Click="AddCMDCommand_Click" Margin="5,0"/>
                </StackPanel>
                <DataGrid x:Name="CMDLineGrid" AutoGenerateColumns="False" DockPanel.Dock="Top" Height="300">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Имя" Binding="{Binding Name}" Width="100"/>
                        <DataGridTextColumn Header="Команда" Binding="{Binding Command}" Width="200"/>
                        <DataGridTextColumn Header="Расположение" Binding="{Binding Location}" Width="100"/>
                    </DataGrid.Columns>
                </DataGrid>
                <TextBlock x:Name="CMDLineStatus" DockPanel.Dock="Bottom" Margin="5"/>
            </DockPanel>
        </TabItem>

        <!-- Вкладка модулей -->
        <TabItem Header="ДРУГОЕ" x:Name="ModulesTab">
            <DockPanel>
                <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="5">
                    <Label Content="Доступные функции:"/>
                    <ComboBox x:Name="ModulesCombo" Width="200" Margin="5,0" 
                          SelectionChanged="ModulesCombo_SelectionChanged"/>
                    <Button Content="Загрузить модуль" Click="LoadModule_Click" Margin="5,0"/>
                    <Button Content="Выгрузить модуль" Click="UnloadModule_Click" Margin="5,0"/>
                </StackPanel>
                <ContentControl x:Name="ModuleContent" DockPanel.Dock="Top" Height="400"/>
                <TextBlock x:Name="ModuleStatus" DockPanel.Dock="Bottom" Margin="5"/>
            </DockPanel>
        </TabItem>
    </TabControl>
</Window>